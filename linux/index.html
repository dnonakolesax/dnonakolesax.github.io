<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VKAT V GO</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 10px 0 10px 0;
        }
		img {
			width: 100%
		}
        #html-output {
            margin-bottom: 20px;
			margin-left: auto;
			margin-right: auto;
			width: 40vw;
			border: 1px solid gray;
			border-radius:12px;
			padding-left: 10px;
			padding-right: 10px;
        }
		
		@media (max-width: 768px) {
			#html-output {
				width: 90vw !important;
			}
		}
    </style>
</head>
<body>
    <div id="html-output"></div>
	<script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/marked-highlight/lib/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
    <script>
        function convertMarkdown() {
			const { Marked } = globalThis.marked;
			const { markedHighlight } = globalThis.markedHighlight;
            const markdown = `# Linux

## Соединения

Количество соединений в linux ограничено количеством файловых дескрипторов:

\`\`\`bash
cat /proc/sys/fs/file-max
\`\`\`

Помимо системного ограничения количества файловых дескрипторов, у каждого пользователя есть свои лимиты. Они настраиваются в системном файле limits.conf (nofile) или, при запуске процесса под управлением systemd, в unit-файле systemd (LimitNOFILE). Чтобы увидеть значение по умолчанию запустите:

\`\`\`bash
ulimit -n
\`\`\`

Кроме того, система ограничивает и количество воркеров

Netstat — сетевая утилита командной строки в Linux, которая предоставляет информацию о текущих соединениях TCP/IP, таблицах маршрутизации, статистике интерфейса и т. д

## Потоки и процессы

|Элементы, присущие каждому процессу|Элементы, присущие каждому потоку
|-|-|
|Адресное пространство|Счётчик команд|
|Глобальные перменные|Регистры|
|Открытые файлы|Стек|
|Дочерние процессы|Состояние|
|Необработанные аварийные сигналы||
|Сигналы и обработчики сигналов||
|Учётная информация||

Cписок процессов: ps 
Послать сигнал KILL {procID}
Адресное пространство: cat /proc/{procId}/maps

Информация о CPU: cat /proc/cpuinfo
Информация о памяти: cat /proc/meminfo

Основные сигналы:

1. SIGUSR1, SIGUSR2 - пользовательские сигналы
2. SIGABRT (abort) - аварийная остановка с дампом памяти
3. SIGALRM (alarm) - сигнал, посылаемый при истечении времени
4. SIGFPE (floating point exception) - попытка выполнения ошибочной арифметической операции
5. SIGHUP (hangup) - потеря соединения с терминалом пользователя
6. SIGILL (illegal instruction) - попытка выполнить неверную инструкцию
7. SIGINT (interrupt) - остановка процесса с терминала (ctrl-c)
8. SIGKILL - немедленное завершение процесса 
9. SIGSEGV (segmentation fault) - обращение к несуществующей или запрещённой процессу области памяти, ошибка сегментации - отказ страниц.
10. SIGTERM (terminate) - завершение процесса
11. SIGSTOP - принудительная приостановка выполнения
12. SIGTSTP (TTY stop) - принудительная остановка, посылаемая с терминала (ctrl-z)
13. SIGBUS (bus - шина данных) - ошибка шины при обращении к физической памяти.
14. SIGSYS (system call) - попытка передать неверный аргумент в системный вызов
15. SIGURG (urgent) - появление срочных данных для чтения на сокете
16. SIGCONT (continue) - продолжить остановленный процесс
17. SIGCHLD (chld) - изменение статуса дочернего процесса (завершён, приостановлен, возобновлён).   

Потребление можно отследить с помощью htop

procfs — специальная файловая система, используемая в UNIX-подобных операционных системах. Позволяет получить доступ к информации из ядра о системных процессах. Необходима для выполнения таких команд как ps, w, top. Обычно её монтируют на /proc.
sysfs — виртуальная файловая система в операционной системе Linux. Экспортирует в пространство пользователя информацию ядра Linux о присутствующих в системе устройствах и драйверах. Обычно её монтируют на /sys.

## Файловая система

Листинг файлов в директории: ls

У каждого файла есть свои модификаторы доступа:

dr--rw-r-x

d - тип файла(прочерк - файл, d - директория, l - link, символическая (мягкая) ссылка, s - socket, сокет, p - pipe, канал, b - block device, блочное устройство, c - character device, символьное устройство)
r - право на чтение
w - право на запись
x - право на исполнение
Первый блок rwx - права пользователя, второй - права группы, третий - права всех остальных
Устанавливается с помощью команды chmod. Например, chmod 777 - все права всем пользователям.
Помимо них, есть ещё 4 секретных бита:
- SUID - set user id upon execution - исполняемый файл запустится с правами владельца - chmod u+s
- SGID - set group id upon execution - исполняемый файл запустится от имени группы, владеющей файлом - chmod g+s
- StickyBit - файлы в директории могут быть удалены только владельцами этих файлов (например, tmp) - chmod +t
- ImmutableBit - над файлом запрещены модификация, переименование, удаление, возможность создавать мягкие (soft) и жесткие (hard) ссылки - chmod +i, выполняется только от суперпользователя

Для расширенного контроля можно использовать ACL - Access Control List
Виды файловых систем, предлагаемых при установке ОС на базе Linux:

- Ext;
- Ext2;
- Ext3;
- Ext4;
- JFS;
- XFS;
- Btrfs;
- Swap.

Выделяют такие типы файлов Linux:

- обычные (regular file);
- именованный канал (named pipe);
- файл для туннелей, устройств (device file);
- soft link (символическая ссылка);
- директории (каталоги);
- сокет (socket);
- дверь (door).

Основные директории:

- /home - домашняя директория
- /bin /sbin - исполняемые файлы
- /opt - установленные вручную программы и приложения
- /usr - Unix System Resources. Директория принадлежит пользовательским приложениям в отличие от /bin или /sbin, которые принадлежат приложениям, включенным в систему.
- /lib /lib32 /lib64 - директории библиотечных файлов
- /boot - статический загрузчик
- /sys - место, где пользователь (user) взаимодействует с ядром (kernel)
- /tmp - временные файлы
- /dev - файлы устройств
- /proc - псевдофайлы процессов
- /run - виртуальная файловая система tmpfs для хранения файлов, связанных с выполняющимися процессами
- /root - домашняя директория пользователя root
- /srv - service catalog - данные для конкретной веб-страницы

В отдельных директориях файлы применяют inode (индексный узел). Этот узел хранит адрес блока диска и файловые атрибуты.
Inode содержит метаданные файла или каталога, такие как права доступа, дата и время создания, размер, владелец, группа и расположение данных файла на диске. Inode имеют ограниченный размер, поэтому количество файлов или каталогов, которые могут быть созданы в файловой системе, ограничено.

Пейджинг — это способ представления большого количества однородной информации, когда контент разбивается на страницы. Обычно представляет собой навигационный ссылочный блок. 

Свопинг — это процесс освобождения части оперативной памяти и перенесения данных в заранее созданный файл подкачки на жёстком диске. Если оперативной памяти не хватает, операционная система перемещает часть неиспользуемой информации из RAM в специально созданный файл на жёстком диске компьютера. Таким образом освобождается место в физической оперативной памяти для новых задач.

## Полезные команды

- man - мануал по команде
- grep - поиск с помощью regexp
- cat, tac - вывод файла
- tee - в конвейре вывести результат и в stdout, и в указанный файл (или несколько файлов)
- vim, nano - редактор в терминале
- sed - замена строк с помощью regexp
- tr - замена символов
- awk - grep + sort + sed + uniq
- sort - сортировка
- uniq - исключение повторений
- top, htop - использование памяти и cpu процессами
- ps - все процессы
- netstat - использование сети
- apt - пакетный менеджер
- clear - очистить терминал
- rm - удалить
- cp - скопировать
- mv - переместить
- pwd - текущая директория
- which - местоположение команды
- mkdir - создать директорию
- touch - создать файл или обновить дату последнего доступа
- head, tail - первые или последние n строк
- ssh - удалённое подключение
- tar, gzip - архиватор
- whoami - имя пользователя
- ping - пингануть адрес
- less - просмотр файла со скроллингом
- dig - DNS-информация домена
- bg - остановленные/фоновые задания
- curl, wget - отправить запрос
- git - VCS

Пайплайн (конвейер) делается с помощью |, ввод и вывод перенаправляется с помощью {from}<< и >>{to}
            `
            const marked = new Marked(
								  markedHighlight({
									emptyLangClass: 'hljs',
									langPrefix: 'hljs language-',
									highlight(code, lang, info) {
									  const language = hljs.getLanguage(lang) ? lang : 'plaintext';
									  return hljs.highlight(code, { language }).value;
									}
								  })
								);
            const html = marked.parse(markdown);
            
            document.getElementById('html-output').innerHTML = html;
        }
	convertMarkdown()
    </script>
</body>
</html>          